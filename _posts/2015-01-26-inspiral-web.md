---
layout: post
title: 'Inspiral Web'
date: 2015-01-26 21:17:11 -0300
image: assets/img/a-breaking-non-space/broken-space.jpg
---

_A quick note for context: this post was stolen from a portfolio site I built a few years back. It's about my side project [Inspiral Web](https://nathanfriend.com/inspiral-web/)._

---

<figure>
    <img src="{{ 'assets/img/inspiral-web/header.jpg' | relative_url }}" alt="A drawing generated by Inspiral Web" />
    <figcaption>An example of some squiggles generated by Inspiral Web.</figcaption>
</figure>

Inspiral Web began as an entertaining and nostalgic way to familiarize myself with [D3.js](http://d3js.org/) and [TypeScript](http://typescriptlang.org/). It quickly grew to be one of the most ambitious personal projects I've attempted. Inspiral Web forced me to get creative with the mechanics of the user interface; it was of the utmost importance that manipulating the gears was a tangible, physical, and effortless experience.

## Generating the gears

The simplest way to generate the gear visuals would have been to create a series of .PNGs, one for each available size. However, I wanted the flexibility to easily create new gear sizes in the future (and potentially let users create custom gears). This meant programmatically assembling SVG command strings into an SVG path that described the gear's toothy perimeter. To accomplish this, I had to dust off some of the trigonometry I hadn't touched since 10th grade Geometry. [The result was rather headache-inducing](https://github.com/nfriend/inspiral-web/blob/0eeb48fba9a9bc4a8d27b4c90c3ea184edc2fd58/InspiralWeb/scripts/Shapes/Gear.ts), but ultimately allowed for a great deal of flexibility down the road.

Here's an example of the 30-tooth gear, one of the smaller gear options:

<img src="{{ 'assets/img/inspiral-web/30-tooth-gear.png' | relative_url }}" alt="A gear with 30 teeth" />

Creating new gears is as simple as passing D3 a new `GearOptions` object that specifies the gear's radius, tooth count, and number of holes to punch out of the body of the gear.

## Working with paths

Under the surface, Inspiral Web assembles its SVG definitions by concatenating string after string of command definitions that describe each angle and line of the gear. In order to avoid directly manipulating strings, I wrote a few simple utility objects to wrap the SVG creation process in a compile-time safety net. So instead of doing this:

```ts
var svg = 'M ' + options.radius + ' 0 ';
for (var i = 0; i < options.toothCount; i++) {
  svg +=
    'A' +
    options.radius +
    ' ' +
    options.radius +
    ' ' +
    0 +
    ' ' +
    0 +
    ' ' +
    1 +
    ' ' +
    newX +
    ' ' +
    newY;
  // etc....
}

return svg;
```

... I was able to take advantage of TypeScript's static typing and write this much safer and less error-prone version:

```ts
var pathBuilder = new SVG.PathBuilder(),
pathBuilder.addCommand(new SVG.MCommand(options.radius, 0));
for (var i = 0; i < options.toothCount; i++) {
    pathBuilder.addCommand(new SVG.ACommand(options.radius, options.radius, 0, false, true, newX, newY));
    // etc....
}

return pathBuilder.toString();
```

I was initially tempted to forgo this extra abstraction and just build the strings by hand, but the extra time it took to write this abstraction quickly paid off when I moved on to more complex SVG drawings (like the [Ring Gear](https://github.com/nfriend/inspiral-web/blob/0eeb48fba9a9bc4a8d27b4c90c3ea184edc2fd58/InspiralWeb/scripts/Shapes/RingGear.ts) and the [Beam](https://github.com/nfriend/inspiral-web/blob/0eeb48fba9a9bc4a8d27b4c90c3ea184edc2fd58/InspiralWeb/scripts/Shapes/Beam.ts)).

## Making it natural

Making Inspiral Web easy to use turned out to be much more difficult that I originally thought. Initially, I used a simple click and drag algorithm that based the rotating gear's position on the mouse's angle with respect to the center of the screen. This proved to be overly simplistic, however. For example, take this gear combination:

<img class="rounded" src="{{ 'assets/img/inspiral-web/gear-example.jpg' | relative_url }}" alt="A ring gear with another gear inside it" />

If the user begins dragging on the left edge of the inner gear, the mouse is actually to the _right_ of the center of the screen. This caused the gear to unexpectedly jump depending on where the user initiated the drag. To solve this, I temporarily "move" the center of the screen relative to the start location of the pointer. Then, as the user begins to drag, I slowly ease this virtual "center" back to the true center of the screen. You can witness this yourself by turning on the "cursor tracker" option by pressing <span class="keyboard-key">T</span>.

## Playing around

Watching friends, family, and total strangers create new and unusual creations using Inspiral Web was by and large and the most rewarding part of the project. While I usually stuck to simple, elegant designs with pleasing color themes:

<a href="{{ 'assets/img/inspiral-web/inspiral-web-example-1.png' | relative_url }}">
    <img class="rounded" src="{{ 'assets/img/inspiral-web/inspiral-web-example-1.png' | relative_url }}" alt="An example of an Inspiral Web drawing" />
</a>

<a href="{{ 'assets/img/inspiral-web/inspiral-web-example-2.png' | relative_url }}">
    <img class="rounded" src="{{ 'assets/img/inspiral-web/inspiral-web-example-2.png' | relative_url }}" alt="An example of an Inspiral Web drawing" />
</a>

... others were much more bombastic:

<a href="{{ 'assets/img/inspiral-web/inspiral-web-example-3.png' | relative_url }}">
    <img class="rounded" src="{{ 'assets/img/inspiral-web/inspiral-web-example-3.png' | relative_url }}" alt="An example of an Inspiral Web drawing" />
</a>

<a href="{{ 'assets/img/inspiral-web/inspiral-web-example-4.jpg' | relative_url }}">
    <img class="rounded" src="{{ 'assets/img/inspiral-web/inspiral-web-example-4.jpg' | relative_url }}" alt="An example of an Inspiral Web drawing" />
</a>

Check out the gallery for yourself at [nathanfriend.com/inspiral-web/gallery](https://nathanfriend.com/inspiral-web/gallery/).

## Reception

Inspiral Web turned out to be a much bigger hit than I expected. Since its release (in October of 2014), Inspiral Web has received over 3,500,000 page hits and more than 100,000 creations have been submitted to the gallery. _(Editor's note: these figures were accurate when this post was originally written in January of 2015. They're probably larger now.)_ Fortunately, I host Inspiral Web on [Microsoft's Azure platform](http://azure.microsoft.com/), which allowed me to quickly scale my server's hardware to meet the sudden demand.

Inspiral Web was featured by the [Adobe Inspire magazine](http://adobe.tumblr.com/post/100086819603/the-amazing-inspirograph) and [Chrome Experiments](https://experiments.withgoogle.com/chrome/inspirograph), made appearances on [Reddit](https://www.reddit.com/r/InternetIsBeautiful/comments/2kwc6k/incredibly_well_done_online_inspirograph_maker/) and [Hacker News](https://news.ycombinator.com/item?id=8475293), and [enjoyed a warm reception on Twitter](https://twitter.com/search?q=inspirograph&src=typd):

<blockquote class="twitter-tweet" lang="en"><p>If this doesn&#39;t make you happy, nothing will: <a href="http://t.co/JTFue1zBIc">http://t.co/JTFue1zBIc</a> Digital spirograph! (via <a href="https://twitter.com/SarDSta">@SarDSta</a>)</p>&mdash; Jennifer Howard (@JenHoward) <a href="https://twitter.com/JenHoward/status/522468706216316929">October 15, 2014</a></blockquote>

<blockquote class="twitter-tweet" lang="en"><p>This is insanely cool: Inspirograph <a href="http://t.co/7KbwteLl2G">http://t.co/7KbwteLl2G</a> You&#39;re welcome.</p>&mdash; Avinash Kaushik (@avinash) <a href="https://twitter.com/avinash/status/522841920570019840">October 16, 2014</a></blockquote>

<blockquote class="twitter-tweet" lang="en"><p>Yes! <a href="https://twitter.com/NathanAFriend">@NathanAFriend</a> recreated our favorite childhood toy for the web: the spirograph! Prepare to lose hours to this: <a href="http://t.co/LVKMNl9M5U">http://t.co/LVKMNl9M5U</a></p>&mdash; Brand New School (@BrandNewSchool) <a href="https://twitter.com/BrandNewSchool/status/522762529903509504">October 16, 2014</a></blockquote>

<blockquote class="twitter-tweet" lang="en"><p>digital spirograph&#10;&#10;DIGITAL SPIROGRAPH&#10;&#10;D*I*G*I*T*A*L S*P*I*R*O*G*R*A*P*H&#10;&#10;<a href="http://t.co/MIU6fmUn4R">http://t.co/MIU6fmUn4R</a></p>&mdash; #MGKmergate (@mightygodking) <a href="https://twitter.com/mightygodking/status/522130725685190656">October 14, 2014</a></blockquote>

<blockquote class="twitter-tweet" lang="en"><p>Got things you need to do? Like eat or sleep? Put if off for a while with this gorgeous digital Spirograph. <a href="http://t.co/Wca7ZIqVNe">http://t.co/Wca7ZIqVNe</a></p>&mdash; craig burston (@skipratmedia) <a href="https://twitter.com/skipratmedia/status/523891260101505024">October 19, 2014</a></blockquote>

<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
